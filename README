== FAST-VM ==
fast-vm â€” script for defining VMs from images provided in thin LVM pool

fast-vm is provides command-line interface to create virtual machines (VMs) in libvirt,
based on imported disks in LVM and XML templates.

Templates of VM disk drives are stored in LVM thinpool LV for space efficiency. Templates
for VMs are just libvirt XMLs with few macros from fast-vm. When creating a VM, fast-vm will
create new writable LVM snapshot of disk drive, define libvirt VM for it and make a static
DHCP reservation for libvirt network on which VM will be.
Optionally fast-vm allows to do some customization of disk drive of new machine before
starting VM using the 'hack files'.

====== Requirements ======
* libvirt with qemu/kvm 
* LVM thin pool support
* LVM VG with reasonable amount of free space (to create LV with thin pool)
* preconfigured VM disk images and XML files (downloadable separately)
* 'dhcp_release' for proper DHCP static leases release
* (optional) 'bash-completion' for bash completion to work
* (optional) 'pv' to show import progress
* (optional) 'curl' to pass http(s) link for image_import

====== Installation ======
=== From source
## As root
1. Install using command 'make install'
2. Continue with 'FAST-VM Configuration'

=== From RPM
## As root
1. Install RPM
  # dnf install fast-vm-*.rpm
2. Continue with 'FAST-VM Configuration'

====== FAST-VM Configuration ======
## As root user
1. Run 'configure-fast-vm' script (/usr/sbin/configure-fast-vm
Script will:
- create default configuration file from your answers
- create LVM thin pool with name and size of your choice
- libvirt NAT network for VMs

2. Add users that will be using to the 'libvirt' group

====== Usage ======
- check the man page fast-vm(8)

====== Configuration ======
- check the man page configure-fast-vm(8) and fast-vm.conf(5)

====== Known bugs/limitation ======
* initial setup requires root
* tested on the Gentoo and Fedora 22
* Gentoo libvirt special requirements in /etc/libvirt/libvirtd.conf
** unix_sock_group = "libvirt"
** unix_sock_rw_perms = "0770"
* Gentoo might require user to be in group 'kvm' to use guestfish from hacks files
* Fedora 22 BUG: libvirt-daemon shipped on installation media doesn't create the 'libivrt' group.
  updating the package solves the problem
* VM images are provided separately
  - publicaly available images can be found at  https://github.com/OndrejHome/fast-vm-public-images
* using 'dhcp_release' to remove DHCP static reservation is not the cleanest
  way of doing so, but there is no other supported way of doing this through libvirt
  (TODO: make RFE/BUG into libvirt)
* BUG: sometimes the VM doesn't get designated IP address because the dnsmasq holds
       the lease for some older MAC address (dhcp_release should be fixing this but
       it's not 100% working solution)

===== Upgrading from the 0.2 to 0.3 =====
* version 0.2 required root to run, 0.3 doesn't require root for normal operations
* first copy /root/.fast-vm/config into /etc/fast-vm.conf (this is new central configuration file)
* update hack files and libvirt definitions:
** due to some changes to way how to connect to libvirt you will have to download new "hack files" for the
version taht you have imported or you can just re-import images and hack files would get updateed 
  or
** copy all '.xml' and '.sh' files from /root/.fast-vm/ into your user $HOME/.fast-vm/ to be able to use 
images that are already imported

====== Where the files get installed ======
- check Makefile for exact locations

=== Author ===
Ondrej Famera <ofamera@redhat.com> or <ondrej-xa2iel8u@famera.cz>
